"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,i,a){return i&&e(t.prototype,i),a&&e(t,a),t}}(),Game=function(){function Game(e,t,i,a,o){_classCallCheck(this,Game),this.player=document.querySelectorAll(e)[0],this.coins=document.querySelectorAll(t),this.lava=document.querySelectorAll(i),this.lands=document.querySelectorAll(a),this.coinsLocation=Array(),this.lavaLocation=Array(),this.landsLocation=Array(),this.disabledMoves=Array(),this.populateCoinLocations(),this.populateLavaLocations(),this.populateLandLocations(),this.distance=o||10,this.score=0,this.deads=0,this.liveProperties=["score","deads"],Game.UP="38",Game.DOWN="40",Game.LEFT="37",Game.RIGHT="39",Game.DIRECTION={up:Game.UP,down:Game.DOWN,left:Game.LEFT,right:Game.RIGHT},Game.OPP_DIRECTION={up:Game.DOWN,down:Game.UP,left:Game.RIGHT,right:Game.LEFT}}return _createClass(Game,[{key:"move",value:function(e){e=e||window.event;var t=this.player.getBoundingClientRect(),i=void 0;e.keyCode==Game.UP&&this.checkAllowedMove(Game.UP)?(i=t.top-this.distance,this.player.style.top=i+"px",this.enableMove(Game.DOWN)):e.keyCode==Game.DOWN&&this.checkAllowedMove(Game.DOWN)?(i=t.top+this.distance,this.player.style.top=i+"px",this.enableMove(Game.UP)):e.keyCode==Game.LEFT&&this.checkAllowedMove(Game.LEFT)?(i=t.left-this.distance,this.player.style.left=i+"px",this.enableMove(Game.RIGHT)):e.keyCode==Game.RIGHT&&this.checkAllowedMove(Game.RIGHT)&&(i=t.left+this.distance,this.player.style.left=i+"px",this.enableMove(Game.LEFT)),this.lastMove=e.keyCode,this.checkBoundary(this.player.getBoundingClientRect(),e.keyCode),this.checkWinner(t,this.coinsLocation),this.checkLava(t,this.lavaLocation),this.liveUpdate()}},{key:"checkWinner",value:function(e,t){for(var i=0;i<this.coinsLocation.length;i++)this.checkOverlap(e,this.coinsLocation[i])&&this.score++}},{key:"checkLava",value:function(e,t){for(var i=0;i<this.lavaLocation.length;i++)this.checkOverlap(e,this.lavaLocation[i])&&(this.score=0,this.deads++)}},{key:"checkLand",value:function(e){for(var t=0;t<this.landsLocation.length;t++)if(this.checkOverlap(e,this.landsLocation[t]))return!0;return!1}},{key:"checkBoundary",value:function(e,t){e.top<=0&&this.disableMove(Game.UP),e.left<=0&&this.disableMove(Game.LEFT),this.checkLand(e)&&this.disableMove(t.toString())}},{key:"disableMove",value:function(e){this.disabledMoves.push(e)}},{key:"enableMove",value:function(e){for(var t=0;t<this.disabledMoves.length;t++){var i=this.disabledMoves.indexOf(e);i>-1&&this.disabledMoves.splice(i,1)}}},{key:"checkAllowedMove",value:function(e){if(0==this.disabledMoves.length)return!0;for(var t=0;t<this.disabledMoves.length;t++)if(e==this.disabledMoves[t])return!1;return!0}},{key:"checkOverlap",value:function(e,t){return!(e.right<t.left||e.left>t.right||e.bottom<t.top||e.top>t.bottom)}},{key:"populateCoinLocations",value:function(){for(var e=0;e<this.coins.length;e++)this.coinsLocation[e]=this.coins[e].getBoundingClientRect()}},{key:"populateLavaLocations",value:function(){for(var e=0;e<this.lava.length;e++)this.lavaLocation[e]=this.lava[e].getBoundingClientRect()}},{key:"populateLandLocations",value:function(){for(var e=0;e<this.lands.length;e++)this.landsLocation[e]=this.lands[e].getBoundingClientRect()}},{key:"liveUpdate",value:function liveUpdate(){for(var val=void 0,el=void 0,i=0;i<this.liveProperties.length;i++)val=eval("this."+this.liveProperties[i]),el=document.getElementById("lava--"+this.liveProperties[i]),el.innerHTML=val}}]),Game}();